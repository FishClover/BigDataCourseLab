# Hive综合实验：分析车辆销售数据
## 1、实验描述

* 针对汽车销售数据，使用HiveQL语句来分析统计汽车行业、市场、个人等相关的数据。

* 实验时长：45分钟

* 主要步骤：
    * 启动Hadoop集群
    * 进入Hive命令行
    * 创建数据库、数据表
    * 加载或导入数据
    * 用Hive SQL完成需求

## 2、实验环境

-   虚拟机数量：3
-   系统版本：Centos 7.5
-   Hadoop版本：Apache Hadoop 2.7.3
-   Hive版本：Apache Hive 2.1.1
-   MySQL版本：5.7.18

## 3、相关知识点

-   Hive客户端
-   Hive命令行相关命令
-   常见Hive分析技巧

## 4、实验步骤
### 4.1 准备和查看数据

4.1.1 查看experiment文件夹中的cars.txt文件，为山西省2013汽车销售数据，检查数据格式和内容。

4.1.2 数据字段说明：

时间、销售地点、邮政编码、车辆类型、车辆型号、制造厂商名称、排量、油耗、功率、发动机型号、燃料种类、车外廓长宽高、轴距、前后车轮、轮胎规格、轮胎数、载客数、所有权、购买人相关信息等。

### 4.2 启动Hadoop集群

4.2.1 在master使用$ start-all.sh命令启动Hadoop集群

4.2.2 在master上运行jps，确认NameNode, SecondaryNameNode, ResourceManager进程启动

4.2.3 分别在slave01、slave02上运行jps，确认DataNode, NodeManager进程启动

### 4.3 Hive基本操作
4.3.1 进入Hive客户端

4.3.2 查看现有数据库

4.3.3 创建数据库（名称：cars）

4.3.4 使用数据库（名称：cars），查看‘cars’下的表

4.3.5 创建外部表（表名：cars、各字段名称和类型请查看数据确定）

4.3.6 导入数据

4.3.7 查看前10行数据

### 4.4 汽车行业市场分析

4.4.1 统计乘用车辆和商用车辆的数量

分析：按照‘nature’字段分组，统计出每种使用性质的车辆数量，条件‘nature’不能为null或空；对前面的结果再次查询，‘nature’的值：非运营的为乘用车辆，其它的为商用车辆，将所有‘nature’为非运营的数量累加得到非运营即乘用车辆的总数，同理得出运营即商用车辆的总数。

4.4.2 统计山西省2013年每个月的汽车销售数量的比例

分析：分别查询出2013年汽车销售数量和2013年每个月的汽车销售数量，将查询出的每个月的汽车销售数量分别除以2013年汽车销售数量，得到山西省2013年每个月的汽车销售数量的比例

### 4.3 用户数据市场分析

4.3.1 买车的男女比例

分析：首先查询出性别和总数，按照性别分组，并且性别不能为null和空。然后，从已经查出的数据中分别查出男性和女性的数量。最后，计算男性占比和女性占比并输出。

4.3.2 男女对车的品牌的选择

分析：查询出每个品牌中男性和女性分别购买的数量，按照性别和品牌分组并且品牌不能是null和空。

4.3.3 统计的车辆型号、车辆类型、所有权

分析：统计车辆型号、车辆类型、所有权的数量，此三个字段不能是null和空，按照车型、车辆类型、所有权进行分组。

### 4.4 不同车型销售统计分析

4.4.1 统计不同类型车在每个月的销量

分析：统计出每个月，每个车型的销售数量，按照车辆类型和月份分组，并且月份不能是null和空。

4.4.2 通过不同类型（品牌）车销售情况，来统计发动机型号和燃料种类

分析：统计不同品牌、发动机型号、燃料种类的销售数量，按照品牌、发动机型号、燃料种类分组，并且品牌不能是null和空。

### 4.5 针对某一品牌的竞争分析

4.5.1 统计五菱每一个月的销售量

4.5.2 自选条件进行销售量分析
